define(["angular","route"],function(){var o=angular.module("app",["ui.router"]);o.config(["$stateProvider","$urlRouterProvider",function(o,e){e.otherwise("/book"),o.state("book",{url:"/book",views:{header:{templateUrl:"view/header.html"},container:{templateUrl:"view/bookList.html",controller:"bookController",reloadOnSearch:!1},footer:{templateUrl:"view/footer.html"}}}).state("bookDetail",{url:"/books/:id",views:{header:{templateUrl:"view/headerBack.html"},container:{templateUrl:"view/bookDetail.html",controller:"bookDetailController"},footer:{templateUrl:"view/footer.html"}}}).state("movice",{url:"/movice",views:{header:{templateUrl:"view/header.html"},container:{templateUrl:"view/moviceList.html",controller:"moviceController"},footer:{templateUrl:"view/footer.html"}}}).state("music",{url:"/music",views:{header:{templateUrl:""},container:{templateUrl:"view/musicList.html",controller:"musicController"},footer:{templateUrl:"view/footer.html"}}})}]),o.constant("Config",{book_search:"https://api.douban.com/v2/book/search",book_search_id:"https://api.douban.com/v2/book/",music_search:"https://api.douban.com/v2/music/search",music_search_id:"https://api.douban.com/v2/music/",movie_search:"https://api.douban.com/v2/movie/search",movie_search_id:"https://api.douban.com/v2/movie/subject/"}),o.run(["$rootScope","$state","$stateParams",function(o,e,t){o.$state=e,o.$stateParams=t,o.$on("$stateChangeSuccess",function(e,t,r,l,a){o.previousState_name=l.name,o.previousState_params=a}),o.back=function(){e.go(o.previousState_name,o.previousState_params)}}]),o.controller("bookController",["$rootScope","$scope","Config","$http",function(o,e,t,r){console.log("bookController"),console.log(t.book_search);window.searchBookList=function(e){console.log(e),e.books.length&&(o.isNoLoaded=!1);for(var t=[],r=0;r<e.books.length;r++){var l=e.books[r],a={id:l.id,image:l.image,origin_title:l.title||"书名未共享",author:l.author[0]||"作者未知",publisher:l.publisher||"出版社未知",price:l.price.split(".")[0]||"未知",pages:l.pages};t.push(a)}o.bookList=t,console.log(o.bookList)},e.search=function(){r.jsonp(t.book_search+"?callback=searchBookList&count=10&q="+e.keyword)}}]),o.controller("bookDetailController",["$scope","Config","$http","$stateParams",function(o,e,t,r){console.log(r.id),t.jsonp(e.book_search_id+r.id+"?callback=callback_bookDetail&"),window.callback_bookDetail=function(e){console.log(e),o.data=e}}]),o.controller("moviceController",function(){console.log("moviceController")}),o.controller("musicController",function(){console.log("musicController")})});